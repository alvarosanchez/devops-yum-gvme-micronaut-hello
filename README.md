# micronaut-hello

This is a simple hello web application using the Micronaut framework and GraalVM Native Image.

## App JAR

### Build the app JAR

```shell
mvn package
```

**OR** 

```shell
./mvnw package
```

### Run the app JAR

```shell
java -jar target/mn-hello-0.1.jar
```

### Test the app JAR

- http://localhost:8080/ should output "Hello World"

- http://localhost:8080/Micronaut should output "Hello Micronaut"


## App native executable

### Build the app native executable

```shell
mvn package -Dpackaging=native-image
```

**OR** 

```shell
./mvnw package -Dpackaging=native-image
```

### Run the app native executable

```shell
./target/mn-hello
```

### Test the app native executable

- http://localhost:8080/ should output "Hello World"

- http://localhost:8080/Micronaut-Graal-Native should output "Hello Micronaut-Graal-Native"


## Appendix 

### Learning from Micronaut-generated Dockerfiles

Let's use the Micronaut Maven plugins to generate a Dockerfile so we can learn how Micronaut builds and packages native executables in small runtime container images.

#### Default option

Using this command we will see the default Dockerfile generated by Micronaut to build the native executable and package it in a small runtime image.

```shell
mvn mn:dockerfile -Dpackaging=docker-native
```

Here's the [generated default Dockerfile](/_reference/Dockerfile.generated-by-mn-default).

#### "Mostly static" option

Using this command we will see how Micronaut generates a “mostly static” native executable and packages it in a distroless base image.

```shell
mvn mn:dockerfile -Dpackaging=docker-native -Dmicronaut.native-image.base-image-run=gcr.io/distroless/base -Pgraalvm
```

Notice the `-H:+StaticExecutableWithDynamicLibC` in the [generated "mostly static" Dockerfile](/_reference/Dockerfile.generated-by-mn-mostly-static).